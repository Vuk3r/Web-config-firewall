# Minimal modsecurity config for dev
SecRuleEngine DetectionOnly
SecRequestBodyAccess On
SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 13107200

SecAuditEngine On
# SecAuditEngine RelevantOnly # nhẹ hơn On vì chỉ có cảnh báo
SecAuditLog /var/log/modsecurity/modsec_audit.log
SecAuditLogParts ABIFHZ
SecDebugLog /var/log/modsecurity/debug.log
SecDebugLogLevel 2
SecAuditLogType Serial

SecUnicodeMapFile /etc/modsecurity/unicode.mapping 20127

SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 131072
SecRequestBodyInMemoryLimit 131072

SecDefaultAction "phase:1,log,pass"
SecDefaultAction "phase:2,log,pass"

# example rules (unique ids)
SecRule REQUEST_URI "@contains /admin-test" "id:990001,phase:1,deny,status:403,log,msg:'admin-test blocked'"
SecRule ARGS "(?i:(union\s+select|select\s+.*\s+from))" "id:990002,phase:2,deny,status:403,log,msg:'simple sqli block'"
